## 同源策略

### 什么是同源策略
页面源和访问源必须相同，否则浏览器会在 <strong> 请求返回</strong>的过程中拦截

### 源 定义
协议，host，端口 必须一致 写出来也要一样 127.0.0.1 & localhost也不行

### 如果解决跨域
#### 开发环境
JSONP
Proxy 代理 一般用dev server的代理 (不用动服务器)

#### 生产环境 
CORS
Nginx 反向代理


#### CORS
#### 简单请求和需要预检的请求 Preflight
当请求非同源时，浏览器会把请求分成2种

#### 简单请求
- method必须是 head get post
- 请求头只有安全字段 即不能自定义任何的请求头信息
- 请求的 Content-Type 只能是 application/x-www/uro-encoded 或者 multipart/form-data

对于简单请求，浏览器会直接发送，并且在header中加入Origin携带页面源，服务器需要在响应中加入
Access-Control-Allow-Origin: * / 页面源

浏览器会检查响应头 是否满足当前页面源

### 需要预检的请求
不是简单请求就是需要预检的请求
浏览器会先发送一个 Preflight 
其 请求方法为 Options，并且携带header

- Access-Control-Request-meehod 正式请求的方法
- Access-Control-Request-headers 正式请求的自定义头

服务器需要返回
- Access-Control-Allow-Origin 允许的域
- Access-Control-Allow-method 允许请求的方法
- Access-Control-RequAllowest-headers 允许的自定义头
- Access-Control-Allow-Max-Age 过期时间
- 可选 Access-Control-Exposed-Headers 允许暴露的请求头
- 可选 Access-Control-Allow-Credentials 允许携带cookie

浏览器会根据这些 判断是否发送正式请求

### ajax 携带cookie
跨域的情况下 ajax默认不携带cookie 需要设置 withCredential: true

